<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-inherit="mrp.BomOverviewLine"
       t-inherit-mode="extension"
       t-name="cr_mrp_buy_make_customisation.BomOverviewLine">


                <xpath expr="//a[@t-on-click.prevent='() => this.goToAction(data.link_id, data.link_model)']"
                       position="attributes">
            <attribute name="t-attf-class">{{ !data.has_main_vendor ? 'text-danger' : '' }}</attribute>
        </xpath>


        <!-- Add BUY/MAKE column after product name -->
        <xpath expr="//td[@name='td_mrp_bom']" position="after">

             <td t-if="data.is_evr" class="text-center">
                <!-- Editable checkbox if not approved -->
                 <input t-if="!data.approve_to_manufacture"
                        type="checkbox"
                        class="form-check-input"
                        t-att-checked="data.critical"
                        t-att-data-bom-line-id="data.bom_line_id"
                        t-on-change="onCriticalChange"
                        title="Mark as Critical Component"/>

                 <!-- Read-only badge if approved and critical -->
                 <span t-elif="data.approve_to_manufacture and data.critical"
                       class="badge badge-danger bg-danger text-white"
                       title="Critical Component (From MO)">
                    <i class="fa fa-exclamation-triangle me-1"/>Critical
                </span>

                 <!-- Checkmark if approved but not critical -->
                 <span t-elif="data.approve_to_manufacture"
                       class="text-muted"
                       title="Not Critical">
                    -
                </span>
            </td>


            <td t-if="data.is_evr and props.showOptions.buyMakeSelection" class="text-center">
                <select t-if="data.is_buy_make_product"
                        class="form-select form-select-sm"
                        t-att-data-bom-line-id="data.bom_line_id"
                        t-model="data.buy_make_selection"
                        t-on-change="onBuyMakeChange"
                        style="width: 120px; margin: 0 auto;">
                    <option value="">Select...</option>
                    <option value="buy">BUY</option>
                    <option value="make">MAKE</option>
                </select>
                <span t-elif="data.manufacture_purchase == 'buy'" class="badge bg-info">BUY ONLY</span>
                <span t-else="" class="text-muted">-</span>
            </td>
        </xpath>

        <xpath expr="//td[@name='td_used']" position="after">

        <td t-if="data.is_evr and props.showOptions.freeToUse" class="text-center">
                   <t t-if="data.purchase_group_editable">
                       <span t-esc="data.lost"/>
                  </t>
            <t t-else=""/>

            </td>
                </xpath>

    </t>
</templates>